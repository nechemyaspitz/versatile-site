!function(){"use strict";const e=new Set,t=(t,i={})=>e.has(t)?Promise.resolve():new Promise((r,n)=>{const a=document.createElement("script");a.src=t,a.async=!0,Object.entries(i).forEach(([e,t])=>a.setAttribute(e,t)),a.onload=()=>{e.add(t),r()},a.onerror=n,document.head.appendChild(a)}),i=t=>e.has(t)?Promise.resolve():new Promise((i,r)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=t,n.onload=()=>{e.add(t),i()},n.onerror=r,document.head.appendChild(n)}),r=new Map,n=(e,t)=>r.set(e,t),a=e=>r.get(e)||{},s=e=>r.delete(e),o=new Map;async function c(e){window.gsap||await t("https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"),await i("https://cdn.jsdelivr.net/npm/swiper@12/swiper-bundle.min.css"),window.Swiper||await t("https://cdn.jsdelivr.net/npm/swiper@12/swiper-bundle.min.js");const r=document.querySelector(".swiper");if(!r)return void n("home",{destroy:()=>{}});const a=window.matchMedia("(prefers-reduced-motion: reduce)").matches,s=a?0:1.45;let o=null,c=null,l=null,d=!1,u=0;if(window.SplitText&&window.gsap&&gsap.registerPlugin)try{gsap.registerPlugin(SplitText)}catch(e){}function p(e){if(!e||!window.SplitText)return null;if(e.__split)return e.__split;const t=e.querySelector(".slider-product-name");if(!t)return null;const i=new SplitText(t,{type:"chars"});return e.__split=i,gsap.set(i.chars,{yPercent:120,rotate:6,opacity:0,transformOrigin:"0% 100%",willChange:"transform, opacity"}),i}function h(e){const t=p(e);t&&(gsap.killTweensOf(t.chars),gsap.to(t.chars,{yPercent:0,rotate:0,opacity:1,duration:.9,ease:"power3.out",stagger:{each:.02,from:"start"}}))}function m(e,t){const i=e.slides[t].swiperSlideOffset||0;return e.rtlTranslate?i:-i}function g(e,t){a||(e.setTranslate(t),e.slides.forEach(e=>{const t=e.querySelector(".slider-img");if(!t)return;const i="number"==typeof e.progress?e.progress:0;gsap.set(t,{xPercent:28*i})}))}function f(){l&&(l.kill(),l=null)}function y(e){f(),a||(l=gsap.delayedCall(4.2,e))}function w(e,t="next"){if(!o)return;f(),c&&(c.kill(),c=null);const i=function(e){let t=-1;return e.slides.forEach(e=>{const i=parseInt(e.getAttribute("data-swiper-slide-index")||"0",10);!Number.isNaN(i)&&i>t&&(t=i)}),t+1}(e),r=e.activeIndex,n=e.slides[r];let a;a="next"===t?(e.realIndex+1)%i:"prev"===t?(e.realIndex-1+i)%i:"number"==typeof t?(t%i+i)%i:(e.realIndex+1)%i,e.updateSlides(),e.updateSlidesOffset();const l=function(e,t,i){let r=-1,n=1/0;return e.slides.forEach((a,s)=>{if(parseInt(a.getAttribute("data-swiper-slide-index")||"-1",10)!==t)return;const o=m(e,s),c=Math.abs(o-i);c<n&&(n=c,r=s)}),r}(e,a,u);e.slideTo(l,0,!1),e.updateSlides(),e.updateSlidesOffset();const d=e.activeIndex,v=e.slides[d],b=u;let S=m(e,d);if(b===S){const t=e.rtlTranslate?-1:1;S-=t*e.width}c=gsap.timeline({onUpdate:()=>{const t=gsap.getProperty(o,"x");g(e,t)},onComplete:()=>{u=S,y(()=>w(e,"next"))}}),function(e){const t=p(e);t&&(gsap.killTweensOf(t.chars),gsap.to(t.chars,{yPercent:-120,rotate:-4,opacity:0,duration:.5,ease:"power2.in",stagger:{each:.015,from:"end"},onComplete:()=>{gsap.set(t.chars,{yPercent:120,rotate:6,opacity:0})}}))}(n),function(e){const t=p(e);t&&(gsap.killTweensOf(t.chars),gsap.set(t.chars,{yPercent:120,rotate:6,opacity:0}))}(v),c.fromTo(o,{x:b},{x:S,duration:s,ease:"power4.inOut"},0),c.add(()=>h(v),.3*s)}const v=new Swiper(".swiper",{loop:!0,slidesPerView:1,allowTouchMove:!1,speed:0,virtualTranslate:!0,watchSlidesProgress:!0,on:{init(e){o=e.el.querySelector(".swiper-wrapper"),e.slides.forEach(p),e.updateSlides(),e.updateSlidesOffset(),u=m(e,e.activeIndex),gsap.set(o,{x:u,willChange:"transform",force3D:!0}),g(e,u),function(e){if(d||a)return;const t=e.slides[e.activeIndex],i=t?.querySelector(".slider-img");i&&gsap.fromTo(i,{scale:1.12},{scale:1,duration:1,ease:"power2.out"}),h(t),d=!0}(e),y(()=>w(e,"next"))},resize(e){e.updateSlides(),e.updateSlidesOffset(),u=m(e,e.activeIndex),gsap.set(o,{x:u}),g(e,u)}}}),b=()=>{document.hidden?f():y(()=>w(v,"next"))};document.addEventListener("visibilitychange",b);const S=()=>f(),C=()=>y(()=>w(v,"next"));r.addEventListener("mouseenter",S),r.addEventListener("mouseleave",C),n("home",{destroy:()=>{try{document.removeEventListener("visibilitychange",b),r.removeEventListener("mouseenter",S),r.removeEventListener("mouseleave",C)}catch(e){}try{f()}catch(e){}try{c?.kill?.()}catch(e){}try{v?.destroy?.(!0,!0)}catch(e){}}})}function l(){l._ac?.abort?.();const e=new AbortController;l._ac=e;const t=document.querySelector("#filters-open"),i=document.querySelector(".close-filters"),r=document.querySelector(".filter-drawer"),n=document.querySelector(".filter-controls");r&&n&&window.gsap&&(gsap.set(r,{display:"none",opacity:0}),gsap.set(n,{xPercent:100}),t&&t.addEventListener("click",()=>{gsap.set(r,{display:"flex"});gsap.timeline({defaults:{ease:"power1.inOut"}}).to(r,{opacity:1,duration:.1}).to(n,{xPercent:0,ease:"power4.out",duration:.4},.06)},{signal:e.signal}),i&&i.addEventListener("click",()=>{gsap.timeline({defaults:{ease:"power1.inOut",duration:.1},onComplete:()=>gsap.set(r,{display:"none"})}).to(n,{xPercent:100,ease:"power4.in",duration:.2}).to(r,{opacity:0,duration:.05},"-=0.1")},{signal:e.signal}))}const d=window.matchMedia("(prefers-reduced-motion: reduce)").matches;function u(e){e&&gsap.set(e,{force3D:!0,z:.01,backfaceVisibility:"hidden",perspective:1e3})}function p(e){return d?.01:e}function h(e,t={}){if(!window.gsap||!e||0===e.length)return;const{duration:i=.5,stagger:r=.3,y:n=10,ease:a="power2.out",clearProps:s=!0}=t;return e.forEach(e=>u(e)),gsap.fromTo(e,{opacity:0,y:n},{opacity:1,y:0,duration:p(i),ease:a,stagger:{amount:p(r),from:"start"},clearProps:s?"transform,will-change":""})}function m(e){"requestIdleCallback"in window?requestIdleCallback(e,{timeout:1e3}):setTimeout(()=>requestAnimationFrame(e),100)}function g(e){return new Promise(t=>{requestAnimationFrame(()=>{e(),t()})})}async function f(e){window.gsap||await t("https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"),await i("https://cdn.jsdelivr.net/npm/nice-select2@2.1.0/dist/css/nice-select2.css"),window.NiceSelect||await t("https://cdn.jsdelivr.net/npm/nice-select2@2.1.0/dist/js/nice-select2.js");const r=document.querySelector(".product-grid"),a=document.getElementById("filters");if(!r||!a)return void n("collections",{destroy:()=>{}});l();const s=new class{constructor(){this.productContainer=document.querySelector(".product-grid"),this.filterForm=document.getElementById("filters"),this.sortDropdown=document.getElementById("sort-select"),this.resultsCounter=document.querySelector("[data-results-count]"),this.clearButton=document.querySelector(".button.alt"),this.collectionId="c09bba8e-4a81-49c2-b722-f1fa46c75861",this.baseUrl="https://wmkcwljhyweqzjivbupx.supabase.co/functions/v1/generic-collection-filter",this.activeFilters={},this.currentSort="recommended",this.currentPage=1,this.itemsPerPage=30,this.isLoading=!1,this.hasMorePages=!0,this.totalItems=0,this.niceSelect=null,this._ac=new AbortController,this._observer=null,this._sentinel=null,this._respCache=new Map,this.init()}async init(){try{this.initNiceSelect(),this.loadFromURLParams(),this.initEventListeners(),this.initInfiniteScroll(),await this.loadInitialData()}catch(e){console.error("Error initializing filter:",e),this.handleError(e)}}async loadInitialData(){this.currentPage=1,this.hasMorePages=!0,this.clearProductContainer(),await this.fetchItems()}async fetchItems(e=!1){if(!this.isLoading){this.isLoading=!0;try{const t=this.buildRequestUrl();if(this._respCache.has(t)){const i=this._respCache.get(t);return e?this.appendItems(i.items):this.renderItems(i.items),this.updatePagination(i.pagination),this.updateResultsCounter(i.pagination.total),this.updateClearButton(),void(this.isLoading=!1)}const i=await fetch(t);if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);const r=await this.handleResponse(i);this._respCache.set(t,r),e?this.appendItems(r.items):this.renderItems(r.items),this.updatePagination(r.pagination),this.updateResultsCounter(r.pagination.total),this.updateClearButton()}catch(e){console.error("Fetch error:",e),this.handleError(e)}finally{this.isLoading=!1}}}async handleResponse(e){const t=await e.text();if(!e.ok){if(403===e.status)throw new Error("Access denied. Please contact support.");throw new Error(`Server error: ${e.status} ${e.statusText}`)}try{return JSON.parse(t)}catch(e){throw console.error("JSON parse error:",e),console.error("Response text:",t),new Error("Invalid response format from server")}}buildRequestUrl(){const e=new URLSearchParams({collection_id:this.collectionId,page:this.currentPage.toString(),limit:this.itemsPerPage.toString(),sort:this.currentSort});Object.entries(this.activeFilters).forEach(([t,i])=>{if(i.length>0){const r={application:"application-slugs",material:"material",featured:"featured",thickness:"thickness"};if(["colors","color","size","finish"].includes(t))e.set(`filter_${t}`,i.join(","));else{const n=r[t]||t;e.set(`filter_${n}`,i.join(","))}}});return e.set("config",JSON.stringify({searchFields:["name","description","actual-product-name"],sortFields:{"a-z":"name:asc","z-a":"name:desc",recommended:"sort-order:asc",featured:"featured:desc"},relatedItems:{enabled:!0,relationField:"variants"},relatedItemFields:["colors","color","size","finish"],customFilters:{"application-slugs":{type:"ilike"},material:{type:"exact"},featured:{type:"boolean"},thickness:{type:"numeric"},color:{type:"exact"},colors:{type:"exact"},size:{type:"array_contains"},finish:{type:"array_contains"}}})),`${this.baseUrl}?${e.toString()}`}renderItems(e){this.productContainer.innerHTML="";const t=document.createDocumentFragment();e.forEach(e=>{const i=this.createProductElement(e);i.style.opacity="0",u(i.querySelector(".collection_grid-item")),t.appendChild(i)}),this.productContainer.appendChild(t),this.animateItemsIn(),g(()=>{m(()=>this.initImageHover()),m(()=>this.updateProductImages()),m(()=>this.updateProductLinks())})}appendItems(e){const t=document.createDocumentFragment();e.forEach(e=>{const i=this.createProductElement(e);i.style.opacity="0";const r=i.querySelector(".collection_grid-item");r&&u(r),t.appendChild(i)}),this.productContainer.appendChild(t);h(Array.from(this.productContainer.children).slice(-e.length),{duration:.3,stagger:.12,y:6,ease:"power2.out"}),g(()=>{m(()=>this.initImageHover()),m(()=>this.updateProductImages()),m(()=>this.updateProductLinks())})}createProductElement(e){const t=e.name||e["actual-product-name"]||"Untitled",i=e.image?.url||null,r=e.slug||e.webflow_item_id||"",n=`/collections/${r}`,a=document.createElement("div");return a.setAttribute("role","listitem"),a.className="w-dyn-item",a.style.opacity="1",a.innerHTML=`\n        <div class="collection_grid-item" data-base-url="${n}" style="opacity: 1; view-transition-name: ${r};" data-hover-initialized="false">\n          <a href="${n}" class="collection_image-cover" style="display: block; color: inherit; text-decoration: none;">\n            <img src="https://cdn.prod.website-files.com/plugins/Basic/assets/placeholder.60f9b1840c.svg" loading="lazy" alt="" class="thumbnail-cover-img overlay-1">\n            <img src="https://cdn.prod.website-files.com/plugins/Basic/assets/placeholder.60f9b1840c.svg" loading="lazy" alt="" class="thumbnail-cover-img overlay-2">\n            ${this.createProgressiveBlurHTML(i,t)}\n          </a>\n          <div class="gradient-cover"></div>\n          <div class="collection-overlay">\n            <a href="${n}" class="collection_details" style="display: block; text-decoration: none;">\n              <div class="truncate">${t}</div>\n            </a>\n            ${this.createProductMetaHTML(e)}\n            ${this.createVariantThumbnailsHTML(e.related_items,n)}\n          </div>\n        </div>\n      `,a}createProgressiveBlurHTML(e,t){const i=e||"https://cdn.prod.website-files.com/plugins/Basic/assets/placeholder.60f9b1840c.svg",r=t||"product-image";return`\n        <div class="progressive-img-blur w-embed">\n          <div class="blur-img">\n            <div class="progressive-blur" style="--bg: url('${i}');" data-original-bg="${i}">\n              <div class="blur"></div>\n              <div class="blur"></div>\n              <div class="blur"></div>\n              <div class="blur"></div>\n            </div>\n            <img src="${i}" alt="${r}" data-original-src="${i}" data-original-alt="${r}">\n          </div>\n        </div>\n      `}createProductMetaHTML(e){return`\n        <div data-thickness="${e.thickness||""}" data-applications="${e["application-slugs"]||""}" data-material="${e.material||""}" class="product-meta">\n          ${e.featured||!1?'<div class="is-featured-flag"></div>':""}\n        </div>\n      `}createVariantThumbnailsHTML(e,t){if(!e||0===e.length)return'\n          <div class="collection-list-wrapper w-dyn-list">\n            <div role="list" class="variant_thumbnail-list w-dyn-items"></div>\n          </div>\n        ';return`\n        <div class="collection-list-wrapper w-dyn-list">\n          <div role="list" class="variant_thumbnail-list w-dyn-items">\n            ${e.map(e=>{const i=e["image-3"]?.url||"https://cdn.prod.website-files.com/plugins/Basic/assets/placeholder.60f9b1840c.svg",r=e["finish-slugs"]||"",n=this.extractColorName(e.color,e.slug),a=e["size-slugs"]||"",s=e.name||e.slug||e.webflow_item_id||"",o=e.slug||e.webflow_item_id||"";return`\n            <div role="listitem" class="w-dyn-item">\n              <a href="${o?`${t}?variant=${o}`:t}" class="variant-thumb-link" style="display: block; line-height: 0;">\n                <img src="${i}" loading="lazy" alt="${s}" class="variant-thumb" style="cursor: pointer;">\n              </a>\n              <div data-finishes="${r}" data-name="${s}" data-slug="${o}" data-color="${n}" data-sizes="${a}" class="variant-meta"></div>\n            </div>\n          `}).join("")}\n          </div>\n        </div>\n      `}extractColorName(e,t){const i={blue:"blue",green:"green",black:"black",white:"white",grey:"grey",gray:"grey"},r=(t||"").toLowerCase();for(const[e,t]of Object.entries(i))if(r.includes(e))return t;return e||""}normalizeFilterKey(e){const t=(e||"").toString().trim().toLowerCase().replace(/\s+/g,"-");return"color"===t||"colors"===t?"colors":"size"===t||"sizes"===t?"size":"finish"===t||"finishes"===t?"finish":"material"===t||"materials"===t?"material":"application"===t||"applications"===t?"application":t}updateFilters(){this.activeFilters={};this.filterForm.querySelectorAll('input[type="checkbox"]:checked').forEach(e=>{const t=e.name,i=e.value,r=this.normalizeFilterKey(t);this.activeFilters[r]||(this.activeFilters[r]=[]),this.activeFilters[r].push(i)}),this.updateFilterChips()}async applyFilters(){await this.loadInitialData(),this.updateURLParams(),this.updateProductLinks()}updateProductImages(){const e=this.activeFilters.colors||this.activeFilters.color;document.querySelectorAll(".collection_grid-item").forEach((t,i)=>{setTimeout(()=>{if(e&&1===e.length){const i=this.getVariantImageForColor(t,e[0]);i&&this.showImageOverlay(t,i.src,i.alt,!0)}else this.restoreOriginalImage(t)},1*i)})}getVariantImageForColor(e,t){const i=e.querySelectorAll(".variant-thumb"),r=t.toLowerCase();for(const e of i){const t=e.nextElementSibling;if(!t||!t.classList.contains("variant-meta"))continue;const i=t.getAttribute("data-color");if(!i)continue;if(i.split(",").map(e=>e.trim().toLowerCase()).includes(r))return{src:e.src,alt:e.alt}}return null}createBlurImageOverlay(e,t){return`\n        <div class="blur-img top" style="opacity: 0; transition: opacity 0.3s ease;">\n          <div class="progressive-blur" style="--bg: url('${e}');">\n            <div class="blur"></div>\n            <div class="blur"></div>\n            <div class="blur"></div>\n            <div class="blur"></div>\n          </div>\n          <img src="${e}" alt="${t}">\n        </div>\n      `}showImageOverlay(e,t,i,r=!1){const n=e.querySelector(".progressive-img-blur");if(!n)return;const a=n.querySelector(".blur-img.top");a&&(a.style.opacity="0",setTimeout(()=>a.remove(),10)),setTimeout(()=>{const a=this.createBlurImageOverlay(t,i),s=n.querySelector(".blur-img:not(.top)");if(!s)return;s.insertAdjacentHTML("afterend",a);const o=n.querySelector(".blur-img.top");o&&requestAnimationFrame(()=>{o.style.opacity="1",e.dataset.hasOverlay="true",r&&(o.dataset.permanent="true",setTimeout(()=>{this.replaceMainImage(e,t,i)},300))})},r?0:50)}hideImageOverlay(e){const t=e.querySelector(".progressive-img-blur");if(!t)return;const i=t.querySelector(".blur-img.top");i&&!i.dataset.permanent&&(i.style.opacity="0",setTimeout(()=>{i.parentNode&&(i.remove(),e.removeAttribute("data-has-overlay"))},300))}replaceMainImage(e,t,i){const r=e.querySelector(".blur-img:not(.top) img"),n=e.querySelector(".blur-img:not(.top) .progressive-blur");r&&(r.src=t,r.alt=i),n&&n.style.setProperty("--bg",`url('${t}')`)}restoreOriginalImage(e){const t=e.querySelector(".blur-img:not(.top) img"),i=e.querySelector(".blur-img:not(.top) .progressive-blur"),r=e.querySelector(".blur-img.top[data-permanent]");if(!t||!i)return;const n=t.dataset.originalSrc,a=t.dataset.originalAlt,s=i.dataset.originalBg;n&&s&&(r&&(r.style.opacity="0",setTimeout(()=>{r.parentNode&&(r.remove(),e.removeAttribute("data-has-overlay"))},300)),setTimeout(()=>{this.replaceMainImage(e,n,a)},r?300:0))}animateItemsIn(){const e=this.productContainer.querySelectorAll(".w-dyn-item");if(0===e.length)return;const t=Array.from(e).slice(0,12),i=Array.from(e).slice(12);h(t,{duration:.35,stagger:.15,y:8,ease:"power2.out"}),i.length>0&&setTimeout(()=>{gsap.set(i,{opacity:1,y:0})},200)}initImageHover(){document.querySelectorAll(".collection_grid-item").forEach(e=>{if("true"===e.dataset.hoverInitialized)return;const t=e.querySelectorAll(".variant-thumb"),i=e.querySelector(".variant_thumbnail-list");if(0===t.length)return;let r,n=!1;i&&(i.addEventListener("mouseenter",()=>{n=!0,r&&(clearTimeout(r),r=null)}),i.addEventListener("mouseleave",()=>{n=!1,r=setTimeout(()=>{this.hideImageOverlay(e)},200)})),t.forEach(t=>{t.addEventListener("mouseenter",()=>{r&&(clearTimeout(r),r=null);e.querySelector(".blur-img.top[data-permanent]")||this.showImageOverlay(e,t.src,t.alt,!1)}),t.addEventListener("mouseleave",()=>{n||(r=setTimeout(()=>{this.hideImageOverlay(e)},200))})}),e.dataset.hoverInitialized="true"})}initProductNavigation(){}getVariantsForColor(e,t){const i=e.querySelectorAll(".variant-thumb"),r=[];return i.forEach(e=>{const i=e.nextElementSibling;if(!i||!i.classList.contains("variant-meta"))return;const n=i.getAttribute("data-color"),a=i.getAttribute("data-slug");if(!n||!a)return;n.split(",").map(e=>e.trim().toLowerCase()).includes(t)&&r.push(a)}),r}updateProductLinks(){const e=this.activeFilters.colors||this.activeFilters.color;document.querySelectorAll(".collection_grid-item").forEach(t=>{const i=t.dataset.baseUrl;if(!i)return;let r=i;if(e&&1===e.length){const n=this.getVariantsForColor(t,e[0].toLowerCase());1===n.length&&(r=`${i}?variant=${n[0]}`)}const n=t.querySelector(".collection_image-cover"),a=t.querySelector(".collection_details");n&&"A"===n.tagName&&(n.href=r),a&&"A"===a.tagName&&(a.href=r)})}initNiceSelect(){if(this.sortDropdown&&"undefined"!=typeof NiceSelect)try{this.niceSelect=NiceSelect.bind(this.sortDropdown,{searchable:!1,placeholder:"Select...",searchtext:"Search",selectedtext:"geselecteerd"})}catch(e){console.error("Failed to initialize Nice Select 2:",e)}}updateNiceSelect(e){if(this.sortDropdown)try{this.sortDropdown.value=e,this.niceSelect&&this.niceSelect.update()}catch(e){console.error("Failed to update Nice Select:",e)}}initEventListeners(){this.filterForm&&this.filterForm.addEventListener("change",async e=>{"checkbox"===e.target.type&&(this.updateFilters(),await this.applyFilters())},{signal:this._ac.signal}),this.sortDropdown&&this.sortDropdown.addEventListener("change",async e=>{this.currentSort=e.target.value,await this.applyFilters()},{signal:this._ac.signal}),this.clearButton&&this.clearButton.addEventListener("click",async e=>{e.preventDefault(),await this.clearAllFilters()},{signal:this._ac.signal}),this.initFilterChipEvents()}initInfiniteScroll(){this._observer=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&this.hasMorePages&&!this.isLoading&&(this.currentPage++,this.fetchItems(!0))})},{rootMargin:"100px",threshold:.1}),this._sentinel=document.createElement("div"),this._sentinel.style.height="1px",this._sentinel.style.position="absolute",this._sentinel.style.bottom="100px",this._sentinel.style.width="100%",this.productContainer&&this.productContainer.parentNode&&(this.productContainer.parentNode.appendChild(this._sentinel),this._observer.observe(this._sentinel))}updatePagination(e){e&&(this.totalItems=e.total||0,this.hasMorePages=e.hasMore||!1)}updateURLParams(){const e=new URLSearchParams;Object.entries(this.activeFilters).forEach(([t,i])=>{i.length>0&&e.set(t,i.join(","))}),"recommended"!==this.currentSort&&e.set("sort",this.currentSort);const t=e.toString()?`${window.location.pathname}?${e.toString()}`:window.location.pathname;window.history.replaceState({},"",t)}loadFromURLParams(){const e=new URLSearchParams(window.location.search),t=e.get("sort");t&&(this.currentSort=t,this.updateNiceSelect(t));const i={color:["color","colors","Color","Colors"],colors:["colors","color","Colors","Color"],size:["size","sizes","Size","Sizes"],sizes:["sizes","size","Sizes","Size"],finish:["finish","finishes","Finish","Finishes"],finishes:["finishes","finish","Finishes","Finish"],application:["application","applications","Application","Applications"],applications:["applications","application","Applications","Application"],"application-slugs":["application","applications","Application","Applications"],material:["material","materials","Material","Materials","material-type","materialtype"],materials:["materials","material","Materials","Material","material-type","materialtype"],thickness:["thickness","Thickness"]};let r=!1;for(const[t,n]of e.entries()){if(["sort","page","limit","config","collection_id"].includes(t))continue;if(!n)continue;const e=n.split(","),a=i[t]||[t];e.forEach(e=>{let t=null;for(const i of a)if(t=this.filterForm?.querySelector(`input[name="${i}"][value="${e}"]`),t)break;t&&(t.checked=!0,r=!0)})}r?this.updateFilters():this.updateFilterChips()}updateResultsCounter(e){this.resultsCounter&&(this.resultsCounter.textContent=e)}updateClearButton(){if(this.clearButton){const e=Object.keys(this.activeFilters).length>0;this.clearButton.style.opacity=e?"1":"0.5",this.clearButton.disabled=!e}}async clearAllFilters(){this.filterForm.querySelectorAll('input[type="checkbox"]:checked').forEach(e=>e.checked=!1),this.currentSort="recommended",this.updateNiceSelect("recommended"),this.updateFilters(),await this.applyFilters()}clearProductContainer(){this.productContainer&&(this.productContainer.innerHTML="")}updateFilterChips(){const e=document.querySelector(".filter-chip-group");e&&(e.innerHTML="",Object.entries(this.activeFilters).forEach(([t,i])=>{i.forEach(i=>{const r=document.createElement("div");r.className="filter-chip",r.setAttribute("data-chip-value",i),r.setAttribute("data-chip-filter",t);const n=this.getDisplayValueForFilter(i,t);r.innerHTML=`\n              <div class="remove-btn"><div class="text-block-4">x</div></div>\n              <div>${n}</div>\n            `,e.appendChild(r)})}))}getDisplayValueForFilter(e){return e.charAt(0).toUpperCase()+e.slice(1)}initFilterChipEvents(){document.addEventListener("click",async e=>{const t=e.target.closest(".remove-btn");if(!t)return;const i=t.closest(".filter-chip");if(!i)return;const r=i.getAttribute("data-chip-filter"),n=i.getAttribute("data-chip-value");await this.removeFilter(r,n)},{signal:this._ac.signal})}async removeFilter(e,t){const i={colors:["color","colors","Color","Colors"],color:["color","colors","Color","Colors"],size:["size","sizes","Size","Sizes"],finish:["finish","finishes","Finish","Finishes"],application:["application","applications","Application","Applications"],material:["material","materials","Material","Materials","material-type","materialtype"],thickness:["thickness","Thickness"]}[e]||[e];let r=null;for(const e of i)if(r=this.filterForm?.querySelector(`input[name="${e}"][value="${t}"]`),r)break;r&&(r.checked=!1,this.updateFilters(),await this.applyFilters())}handleError(e){console.error("Filter error:",e),this.productContainer&&(this.productContainer.innerHTML=`\n          <div class="error-message" style="grid-column:1 / -1; text-align:center; padding:2rem; background:#fee; border:1px solid #fcc; border-radius:8px; color:#c33;">\n            <h3>Error loading products</h3>\n            <p>${e.message}</p>\n            <button onclick="window.location.reload()" style="margin-top:1rem; padding:0.5rem 1rem; background:#c33; color:white; border:none; border-radius:4px; cursor:pointer;">Reload Page</button>\n          </div>\n        `)}destroy(){try{this._ac?.abort?.()}catch(e){}try{this._observer?.disconnect?.()}catch(e){}try{this._sentinel?.remove?.()}catch(e){}}};window.productFilter=s,window.InfiniteScrollProductFilter=s,n("collections",{destroy:()=>{try{s.destroy()}catch(e){}}})}async function y(e){await i("https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.0/dist/carousel/carousel.css"),await i("https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.0/dist/fancybox/fancybox.css"),window.Carousel||await t("https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.0/dist/carousel/carousel.umd.js"),window.Fancybox||await t("https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.0/dist/fancybox/fancybox.umd.js"),window.Arrows||await t("https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.0/dist/carousel/carousel.arrows.umd.js"),window.Dots||await t("https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.0/dist/carousel/carousel.dots.umd.js"),window.Thumbs||await t("https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.0/dist/carousel/carousel.thumbs.umd.js");const r=document.getElementById("product-carousel"),a=document.querySelector(".product-image"),s=document.querySelector("[data-product-name]");if(!r||!a||!s)return void n("product",{destroy:()=>{}});const o=new class{constructor(){this.slides=[],this.variants=[],this.selectedVariant=null,this.carousel=null,this.fancybox=null,this.initialSlideIndex=0,this.isInitialLoad=!0,this._ac=new AbortController,this.init()}init(){this.extractProductData(),this.determineInitialSlide(),this.buildCarousel(),this.buildVariantButtons(),this.setupFancybox();const e=document.querySelector(".variant-info");e&&(e.style.display="none"),this.handleInitialVariant()}extractProductData(){const e=document.querySelector(".product-image"),t=document.querySelector("[data-product-name]").textContent;this.slides=[{type:"main",src:e.src,alt:`${t} - Main Image`,variantSlug:null,w:1200,h:800}],this.variants=[];document.querySelectorAll(".variants-list .w-dyn-item").forEach(e=>{const i=e.children[0],r=e.querySelector("img"),n=e.querySelector(".product-variant-meta"),a={name:i.textContent,slug:n.dataset.variantSlug,image:r.src,sizes:n.dataset.sizes.split(",").map(e=>e.trim()),finishes:n.dataset.finishes.split(",").map(e=>e.trim())};this.variants.push(a),this.slides.push({type:"variant",src:a.image,alt:`${t} - ${a.name}`,variantSlug:a.slug,w:1200,h:800})})}determineInitialSlide(){const e=new URLSearchParams(window.location.search).get("variant");if(this.initialSlideIndex=0,e&&this.variants.some(t=>t.slug===e)){const t=this.slides.findIndex(t=>t.variantSlug===e);if(-1!==t)return this.initialSlideIndex=t,void(this.selectedVariant=e)}this.variants.length>0?this.selectedVariant=this.variants[0].slug:this.selectedVariant=null}buildCarousel(){const e=document.getElementById("product-carousel");if(e){e.innerHTML="",this.slides.forEach(t=>{const i=document.createElement("div");i.className="f-carousel__slide";const r=document.createElement("img");r.src=t.src,r.alt=t.alt,r.dataset.fancybox="gallery",r.dataset.src=t.src,r.dataset.caption=t.alt,r.className="carousel-image",r.style.cursor="pointer",i.appendChild(r),e.appendChild(i)});try{this.carousel=Carousel(e,{infinite:!0,center:!0,fill:!0,dragFree:!1,initialPage:this.initialSlideIndex},{Arrows:Arrows,Thumbs:Thumbs}).init()}catch(e){console.error("Failed to initialize Carousel:",e)}}}setupFancybox(){Fancybox.bind('[data-fancybox="gallery"]',{Carousel:{Toolbar:{display:{right:["zoomIn","zoomOut","thumbs","close"]}}}})}buildVariantButtons(){const e=document.querySelector(".variant-buttons");e&&(e.innerHTML="",this.variants.forEach(t=>{const i=document.createElement("button");i.className="variant-btn",i.dataset.variantSlug=t.slug,i.innerHTML=`\n          <img src="${t.image}" alt="${t.name}" class="variant-btn-image">\n          <span>${this.slugToName(t.name)}</span>\n        `,i.addEventListener("click",()=>{this.isInitialLoad=!1,this.selectVariant(t.slug,!0)},{signal:this._ac.signal}),e.appendChild(i)}))}handleInitialVariant(){if(this.selectedVariant){new URLSearchParams(window.location.search).get("variant")===this.selectedVariant?this.selectVariant(this.selectedVariant,!0,!1):this.selectVariant(this.selectedVariant,!1,!1)}setTimeout(()=>{this.isInitialLoad=!1},100)}selectVariant(e,t=!0,i=!0){if(this.selectedVariant=e,document.querySelectorAll(".variant-btn").forEach(t=>{t.classList.toggle("selected",t.dataset.variantSlug===e)}),t&&this.carousel){const t=this.slides.findIndex(t=>t.variantSlug===e);if(-1!==t)try{"function"==typeof this.carousel.slideTo?this.carousel.slideTo(t):"function"==typeof this.carousel.goTo?this.carousel.goTo(t):this.carousel.page=t}catch(e){console.error("Error navigating to slide:",e)}}this.displayVariantInfo(e),i&&this.updateURLParams()}displayVariantInfo(e){const t=document.querySelector(".variant-info");if(!e)return void(t&&(t.style.display="none"));const i=this.variants.find(t=>t.slug===e);if(!i)return void(t&&(t.style.display="none"));const r=document.querySelector(".variant-name"),n=document.querySelector(".sizes-list"),a=document.querySelector(".finishes-list");t&&r&&n&&a&&(r.textContent=this.slugToName(i.name),n.innerHTML="",a.innerHTML="",i.sizes.forEach(e=>{const t=document.createElement("div");t.className="size-item",t.textContent=this.slugToName(e),n.appendChild(t)}),i.finishes.forEach(e=>{const t=document.createElement("div");t.className="finish-item",t.textContent=this.slugToName(e),a.appendChild(t)}),t.style.display="block")}slugToName(e){return e.split(/[-_\s]+/).map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" ")}updateURLParams(){const e=new URL(window.location);this.selectedVariant?e.searchParams.set("variant",this.selectedVariant):e.searchParams.delete("variant"),window.history.replaceState(null,"",e)}destroy(){try{this._ac?.abort?.()}catch(e){}try{this.carousel?.destroy?.()}catch(e){}try{window.Fancybox&&Fancybox.destroy&&Fancybox.destroy()}catch(e){}}};n("product",{destroy:()=>o.destroy()})}const w='[data-navigation] a[href]:not([target="_blank"]):not([data-no-barba])';function v(){return document.querySelector("[data-navigation-status]")}function b(){const e=v();e&&e.setAttribute("data-navigation-status","not-active")}function S(){const e=v();if(!e)return;const t="active"===e.getAttribute("data-navigation-status");e.setAttribute("data-navigation-status",t?"not-active":"active")}function C(e=location.pathname){document.querySelectorAll(w).forEach(t=>{const i=t.getAttribute("href")||"",r=new URL(i,location.origin).pathname===e;t.classList.toggle("w--current",r),r?t.setAttribute("aria-current","page"):t.removeAttribute("aria-current")})}function x(){x._ac?.abort?.();const e=new AbortController;x._ac=e,document.querySelectorAll('[data-navigation-toggle="toggle"]').forEach(t=>{t.addEventListener("click",S,{signal:e.signal})}),document.querySelectorAll('[data-navigation-toggle="close"]').forEach(t=>{t.addEventListener("click",b,{signal:e.signal})}),document.addEventListener("keydown",e=>{"Escape"===e.key&&b()},{signal:e.signal}),document.querySelectorAll(w).forEach(t=>{t.addEventListener("click",()=>b(),{signal:e.signal})})}function I(){document.querySelectorAll("[data-button-animate-chars]").forEach(e=>{const t=e.textContent;e.innerHTML="",[...t].forEach((t,i)=>{const r=document.createElement("span");r.textContent=t,r.style.transitionDelay=.015*i+"s"," "===t&&(r.style.whiteSpace="pre"),e.appendChild(r)})})}const F=()=>{if(window.Webflow&&window.Webflow.require)try{window.Webflow.destroy(),window.Webflow.ready(),window.Webflow.require("ix2").init()}catch(e){}};let E=null,P=null;function L(){return new Promise(e=>{if(!window.gsap)return void e();const t=document.querySelector(".slider-wrap"),i=document.querySelector(".product-grid");if(!t||!i)return void e();const r=function(){if(P)return P;const e=window.location.pathname.match(/\/collections\/([^/?]+)/);return e?e[1]:null}(),n=i.querySelector(`[data-base-url="/collections/${r}"]`);if(!n)return console.warn("No matching collection item found for reverse morph"),void e();const a=i.querySelectorAll(".collection_grid-item"),s=Array.from(a).some(e=>function(e){if(!e)return!1;const t=window.getComputedStyle(e);return parseFloat(t.opacity)>.1&&"none"!==t.display}(e));u(t),u(n);const o=t.getBoundingClientRect(),c=n.getBoundingClientRect(),l=c.width/o.width,d=c.height/o.height,h=c.left-o.left,m=c.top-o.top;gsap.set(n,{opacity:0}),s&&gsap.set(a,{opacity:0}),gsap.to(t,{x:h,y:m,scaleX:l,scaleY:d,transformOrigin:"top left",duration:p(.7),ease:"power3.inOut",onComplete:()=>{gsap.set(n,{opacity:1,clearProps:"all"}),s?gsap.to(a,{opacity:1,duration:p(.3),ease:"power2.out",clearProps:"all"}):gsap.fromTo(a,{opacity:0,y:10},{opacity:1,y:0,duration:p(.4),stagger:{amount:p(.2),from:"start"},ease:"power2.out",clearProps:"transform"}),e()}})})}function q(){E&&E.remove(),E=null,P=null}function T(){document.removeEventListener("click",A,!0),document.addEventListener("click",A,!0)}function A(e){if(!document.querySelector('[data-barba-namespace="collections"]'))return;e.target.closest(".collection_image-cover, .collection_details")&&function(e){const t=e.target.closest(".collection_grid-item");if(!t||!window.gsap)return;const i=t.querySelector('a[href*="/collections/"]');if(i){const e=i.href.match(/\/collections\/([^/?]+)/);e&&(P=e[1])}const r=t.getBoundingClientRect(),n=window.getComputedStyle(t);E=t.cloneNode(!0),E.style.cssText=`\n    position: fixed;\n    top: ${r.top}px;\n    left: ${r.left}px;\n    width: ${r.width}px;\n    height: ${r.height}px;\n    margin: 0;\n    z-index: 10000;\n    pointer-events: none;\n    border-radius: ${n.borderRadius};\n  `,E.setAttribute("data-flip-clone","true"),u(E)}(e)}function _(){if(x(),C(),!window.barba||!barba.init)return void console.error("Barba not found. Include @barba/core before this script.");window.barbaPrefetch&&barba.use(barbaPrefetch),"scrollRestoration"in history&&(history.scrollRestoration="manual"),barba.init({prevent:({el:e})=>e?.hasAttribute?.("data-no-barba"),transitions:[{name:"product-morph",from:{namespace:["collections"]},to:{namespace:["product"]},async leave({current:e}){E&&!document.body.contains(E)&&document.body.appendChild(E);const t=e.container.querySelectorAll(".collection_grid-item");window.gsap&&t.length>0&&gsap.to(t,{opacity:0,duration:.2,ease:"power2.out"})},enter({next:e}){e.container.style.opacity=1;const t=e.container.querySelector(".slider-wrap");t&&(t.style.opacity=0)},async after({next:e}){await new Promise(e=>{if(!E||!window.gsap)return q(),void e();const t=document.querySelector(".slider-wrap");if(!t)return q(),void e();u(t);const i=E.getBoundingClientRect(),r=t.getBoundingClientRect(),n=i.width/r.width,a=i.height/r.height,s=i.left-r.left,o=i.top-r.top;gsap.set(t,{x:s,y:o,scaleX:n,scaleY:a,transformOrigin:"top left",opacity:1});const c=gsap.timeline({onComplete:()=>{q(),e()}});c.to(E,{opacity:0,duration:p(.25),ease:"power2.in"},0),c.to(t,{x:0,y:0,scaleX:1,scaleY:1,duration:p(.8),ease:"power3.inOut",clearProps:"transform"},0)})}},{name:"product-reverse-morph",from:{namespace:["product"]},to:{namespace:["collections"]},leave({current:e}){const t=e.container.querySelectorAll(":scope > *:not([data-barba]):not(.slider-wrap)");window.gsap&&t.length>0&&gsap.to(t,{opacity:0,duration:.2,ease:"power2.out"})},enter({next:e}){e.container.style.opacity=1},async after({next:e}){await L()}},{name:"fade",leave({current:e}){if(window.gsap)return gsap.to(e.container,{opacity:0,duration:.2,ease:"power1.out"})},enter({next:e}){if(window.gsap)return e.container.style.opacity=0,gsap.to(e.container,{opacity:1,duration:.2,ease:"power1.out"})}}],views:[{namespace:"home",beforeLeave(){a("home")?.destroy?.(),s("home")},async afterEnter(){await c()}},{namespace:"collections",beforeLeave(){!function(){const e=document.querySelector(".product-grid"),t=location.href;if(!e)return;const i=window.productFilter?{activeFilters:window.productFilter.activeFilters,currentSort:window.productFilter.currentSort,currentPage:window.productFilter.currentPage,hasMorePages:window.productFilter.hasMorePages,totalItems:window.productFilter.totalItems}:null;o.set(t,{html:e.innerHTML,state:i,scrollY:window.scrollY})}(),a("collections")?.destroy?.(),s("collections")},async afterEnter(e){if("back"===e.trigger&&function(){const e=location.href,t=o.get(e);if(!t)return!1;const i=document.querySelector(".product-grid"),r=document.getElementById("filters");if(!i||!r)return!1;if(i.innerHTML=t.html,i.querySelectorAll(".w-dyn-item, .collection_grid-item").forEach(e=>{e.style.opacity="1",e.style.transform="none"}),!window.InfiniteScrollProductFilter)return!1;const n=window.InfiniteScrollProductFilter.constructor,a=Object.create(n.prototype);return a.productContainer=i,a.filterForm=r,a.sortDropdown=document.getElementById("sort-select"),a.resultsCounter=document.querySelector("[data-results-count]"),a.clearButton=document.querySelector(".button.alt"),a.collectionId="c09bba8e-4a81-49c2-b722-f1fa46c75861",a.baseUrl="https://wmkcwljhyweqzjivbupx.supabase.co/functions/v1/generic-collection-filter",a.itemsPerPage=30,a.isLoading=!1,a.niceSelect=null,a._ac=new AbortController,a._observer=null,a._sentinel=null,a._respCache=new Map,a.activeFilters=t.state?.activeFilters||{},a.currentSort=t.state?.currentSort||"recommended",a.currentPage=t.state?.currentPage||1,a.hasMorePages=!!t.state?.hasMorePages,a.totalItems=t.state?.totalItems||0,window.productFilter&&(a.initImageHover=window.productFilter.initImageHover.bind(a),a.updateProductImages=window.productFilter.updateProductImages.bind(a),a.updateProductLinks=window.productFilter.updateProductLinks.bind(a),a.updateResultsCounter=window.productFilter.updateResultsCounter.bind(a),a.initInfiniteScroll=window.productFilter.initInfiniteScroll.bind(a),a.initImageHover(),a.updateProductImages(),a.updateProductLinks(),a.updateResultsCounter(a.totalItems),a.initInfiniteScroll()),window.productFilter=a,!0}())return F(),void T();await f(),T()}},{namespace:"product",beforeLeave(){a("product")?.destroy?.(),s("product")},async afterEnter(){await y()}}]}),barba.hooks.before(()=>{b()}),barba.hooks.after(e=>{if("back"===e.trigger||"forward"===e.trigger){const e=barba.history.current?.scroll?.y??0;window.scrollTo(0,e)}else window.scrollTo({top:0,behavior:"auto"})}),barba.hooks.afterEnter(e=>{C(e?.next?.url?.path||location.pathname),F(),I()}),I(),F();const e=document.querySelector('[data-barba="container"]')?.getAttribute("data-barba-namespace");"home"===e?c():"collections"===e?f():"product"===e&&y()}"undefined"!=typeof window&&window.addEventListener("beforeunload",q);const k=(new Date).toISOString();console.log("%c🚀 Versatile Site SPA v1.5.0","color: #00ff00; font-weight: bold; font-size: 16px;"),console.log("%c✅ Loaded from GitHub Pages","color: #00aaff; font-weight: bold;"),console.log(`%c📦 Deploy time: ${k}`,"color: #ffaa00;"),console.log("%c✨ v1.5: ULTRA-SMOOTH COLLECTIONS - Zero jank animations!","color: #ff6600; font-weight: bold;"),document.addEventListener("DOMContentLoaded",()=>{console.log("%c🎯 Barba.js initializing...","color: #ff00ff;"),_()})}();
